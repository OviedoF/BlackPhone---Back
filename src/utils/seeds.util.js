const PricesTableInfo = require('../models/PricesTableInfo.model');
const Province = require('../models/Province.model');
const PricesRules = require('../models/PricesRules.model');
const WebTexts = require('../models/WebTexts.model');
const provinces = require('./provinces.json');
const Config = require('../models/Config.model');
const createInitialStatus = require('./createInitialStatus');
const createInitialAdmin = require('./createInitialAdmin');

const initialPricesTableInfo = async () => {
    const pricesTableInfoDocs = await PricesTableInfo.find();

    if (pricesTableInfoDocs.length > 0) return;

    const pricesTableInfo = new PricesTableInfo({
        headers: [{
            name: 'Marca',
            id: 'brand'
        }, {
            name: 'Modelo',
            id: 'model'
        }, {
            name: 'Pantalla',
            area: 'Local',
            publicName: 'Fallo en la pantalla',
            id: 'screen',
            idArea: 'local'
        }, {
            name: 'Bater√≠a',
            area: 'Local',
            publicName: 'Fallo en la bater√≠a',
            id: 'battery',
            idArea: 'local'
        }, {
            name: 'No Carga',
            area: 'Local',
            publicName: 'No carga',
            id: 'notCharging',
            idArea: 'local'
        }, {
            name: 'Pantalla',
            area: 'Fuera',
            publicName: 'Fallo en la pantalla',
            id: 'screen',
            idArea: 'outside'
        }, {
            name: 'Bater√≠a',
            area: 'Fuera',
            publicName: 'Fallo en la bater√≠a',
            id: 'battery',
            idArea: 'outside'
        }, {
            name: 'No Carga',
            area: 'Fuera',
            publicName: 'No carga',
            id: 'notCharging',
            idArea: 'outside'
        }, {
            name: 'Pantalla',
            area: 'Mayorista',
            publicName: 'Fallo en la pantalla',
            id: 'screen',
            idArea: 'wholesale'
        }, {
            name: 'Bater√≠a',
            area: 'Mayorista',
            publicName: 'Fallo en la bater√≠a',
            id: 'battery',
            idArea: 'wholesale'
        }, {
            name: 'No Carga',
            area: 'Mayorista',
            publicName: 'No carga',
            id: 'notCharging',
            idArea: 'wholesale'
        }]
    });

    await pricesTableInfo.save();

    console.log('[SEEDER] PricesTableInfo seeded! üå±');
}

const setInitialProvinces = async () => {
    const provincesDocs = await Province.find();

    if (provincesDocs.length > 0) return;

    const provincesArray = JSON.parse(JSON.stringify(provinces));

    await Province.insertMany(provincesArray);

    console.log('[SEEDER] Provinces seeded! üå±');
}

const setInitialPricesRules = async () => {
    const pricesRulesDocs = await PricesRules.find();

    if (pricesRulesDocs.length > 0) return;

    const pricesRules = new PricesRules({
        priceWholesalerOutGranada: 0,
    });

    await pricesRules.save();

    console.log('[SEEDER] PricesRules seeded! üå±');
}

const setInitialWebTexts = async () => {
    const webTextsDocs = await WebTexts.find();

    if (webTextsDocs.length > 0) return;

    const webTexts = new WebTexts({
        home: {
            hero: {
                title: 'Blackphone',
                subTitle: 'Oh no, ¬°tu m√≥vil se ha roto!',
                itemOne: 'Recogemos tu m√≥vil en la direcci√≥n y fecha indicadas.',
                itemTwo: 'Analizamos su estado y reparamos.',
            },
            location: {
                title: 'Si est√°s en Gand√≠a, ¬°Ven a conocernos!',
                description: `Somos una empresa dedicada al arreglo y mantenimiento de m√≥viles, con m√°s de 10 a√±os de experiencia en el mercado.

                ¬°Coja cita para reparaci√≥n en 30 minutos o se lo recogemos y devolvemos reparado en el mismo d√≠a!`,
            },
            doItYourself: {
                title: 'Arregla tu m√≥vil t√∫ mismo',
                subTitle: '¬øTienes capacidad para arreglar tu celular y necesitas repuestos?',
                description: 'En nuestra tienda online encontrar√°s todo lo que necesitas para reparar tu m√≥vil. Desde pantallas, bater√≠as, flex, carcasas, etc.'
            },
            wholesale: {
                title: 'Reparaci√≥n para tiendas y empresas',
                subTitle: '¬øTienes una tienda o empresa y necesitas nuestros servicios?',
                description: 'En Blackphone ofrecemos servicios de reparaci√≥n para tiendas y empresas. Si necesitas reparar un m√≥vil, no dudes en contactar con nosotros.'
            },
            status: {
                title: '¬øC√≥mo va mi reparaci√≥n?',
                subTitle: 'Vea el estado de su reparaci√≥n',
                description: 'En Blackphone, nos gusta que nuestros clientes est√©n informados en todo momento del estado de su reparaci√≥n. Por eso, hemos creado un sistema de seguimiento de reparaciones, para que puedas ver en todo momento el estado de tu reparaci√≥n.'
            },
            brands: {
                title: 'Reparamos todas las marcas',
            }
        },
        aboutUs: [{
            title: 'Nuestra Empresa',
            description: 'Blackphone.net pertenece a Empe Telecomunicaciones S.L, sociedad inscrita en el Registro Mercantil de Gand√≠a: Tomo 1518, Folio 216, Hoja GR:44454. Con CIF ESB19549146.',
            image: 'https://www.ceupe.com/images/easyblog_articles/3119/empresa-conjunta.jpg'
        }],
        aboutUsTitle: 'Sobre Nosotros',
        whyUs: [{
            title: 'Experiencia',
            description: 'Llevamos m√°s de 20 a√±os en el sector de la reparaci√≥n de m√≥viles, tablets y ordenadores.'
        }],
        whyUsTitle: '¬øPor qu√© elegirnos?',
        garanties: [{
            title: 'Devoluciones',
            description: `Derecho de desistimiento: El comprador tiene quince d√≠as h√°biles para el ejercicio del derecho sin necesidad de justificar la decisi√≥n y sin penalizaci√≥n de ninguna clase.

            En Blackphone.net nos esforzamos para ofrecer a nuestros clientes la mejor calidad posible en todos nuestros productos y servicios. Pero si tienes alg√∫n motivo para devolver un producto, le indicamos las instrucciones a continuaci√≥n.
            
            ¬°Le damos la posibilidad de devolver los productos que desees en caso de que no quedes satisfecho, Dispones de 15 d√≠as naturales para cambiar de opini√≥n!
            
            Blackphone.net le da la posibilidad de beneficiarte de 15 d√≠as (que marca el art√≠culo L 121-20 del C√≥digo del Consumidor), para devolver un producto con el que no est√°s satisfecho. Este plazo comienza a partir de la fecha de recepci√≥n de su paquete.
            
            Los productos deben ser devueltos en su condici√≥n de origen, y con el envoltorio original. Si el producto est√° abierto, es imprescindible que tanto el embalaje como el contenido, as√≠ como los accesorios est√©n en perfecto estado. No podremos acceder a su solicitud de devoluci√≥n si el embalaje est√° usado, gastado, manipulado, o el producto o sus accesorios deteriorados.
            
            Este derecho de desistimiento y devoluci√≥n no ser√° de aplicaci√≥n a los bienes confeccionados conforme a las especificaciones del consumidor o claramente personalizados o que, por su naturaleza no puedan ser devueltos o puedan deteriorarse o caducar con rapidez, repuestos que debido a su gran fragilidad hayan sido mal manipulados durante el proceso de montaje o instalaci√≥n, discos y programas inform√°ticos que hubiesen sido desprecintados as√≠ como ficheros inform√°ticos suministrados por v√≠a electr√≥nica susceptibles de ser descargados o reproducidos con car√°cter inmediato y servicios para los que la normativa aplicable prevea tal excepci√≥n. El comprador tendr√° que asumir los gastos de env√≠os s√≠ desea acogerse a su derecho de desistimiento, Blackphone se lo hace f√°cil y se lo recoge o cambia por s√≥lo 7,90‚Ç¨.
            En el caso de que el producto se devolviera por estar defectuoso o no funciona correctamente los gastos de env√≠o correr√°n de nuestra cuenta debiendo seguir el mismo proceso que se indica m√°s adelante. Si el cliente nos avisa de la recepci√≥n del producto defectuoso en las primeras 48h, Blackphone.net se encarga de recogerlo, comprobarlo y vambiarlo sin ning√∫n gasto para el comprador. En el supuesto de que el cliente detectase alg√∫n problema en el momento de la entrega de su pedido (incidencia en transporte : embalaje estropeado, productos faltantes o deteriorados) debe contactar con nuestro centro de atenci√≥n al cliente en el email info@Blackphone.net o al tel√©fono 958 99 11 63 dentro de las primeras 48 horas siguientes a la recepci√≥n. De no ser comunicado, no se aceptar√°n reclamaciones. *Una vez recibida la devoluci√≥n, analizaremos su contenido y se se enviar√° nuevamente el producto o se le abonar√° el importe.
            Si el producto ha dejado de funcionar correctamente en el periodo de garant√≠a, puede optar a contactar con el fabricante presentando nuestra factura o pedirnos a nosotros tramitar la garant√≠a por usted. Blackphone se lo hace f√°cil, pasamos a recogerlo y devolverselo una vez reparado o sustituido por el fabricante ( coste 9,90‚Ç¨). * Si la garant√≠a se refiere a repuestos montados fuera de un servicio t√©cnico oficial, el fabricante se reserva el derecho de tramitar la garant√≠a debido a un posible montaje deficiente, uso de pagementos corrosivos y herramientas inadecuadas.`,
            image: 'https://www.ceupe.com/images/easyblog_articles/3119/empresa-conjunta.jpg'
        }],
        garantiesTitle: 'Garant√≠as',
        wholesales: {
            title: 'Mayoristas',
            description: `
            Si usted es mayorista, distribuidor o tienda de telefon√≠a o electr√≥nica, blackphoneservice.com le ofrece:

            + Descuentos de hasta el 50% sobre PVP en todo nuestro cat√°logo de la web.
            + Stock real y permanente con env√≠o en 24h por s√≥lo 4,90‚Ç¨ o portes gratis para pedidos superiores a 50‚Ç¨. Sin pedido m√≠nimo.
            + Atenci√≥n personalizada y contacto directo con nuestros comerciales.
            
            Rellene este formulario e inmediatamente un agente comercial se pondr√° en contacto con usted para facilitarle sus claves de acceso y el porcentaje de descuento.
            
            Siempre tendr√° a su agente comercial para cualquier duda sobre env√≠os, pagos o devoluciones.
            `,
            image: 'https://www.ceupe.com/images/easyblog_articles/3119/empresa-conjunta.jpg'
        },
        functioning: [{
            title: 'Recogida en su domicilio o lugar de trabajo',
            description: `Recogemos tu m√≥vil en la direcci√≥n y fecha que nos ha indicado. Le enviaremos un mensajero de Nacex/MRW que le dejar√° un comprobante de la recogida. Protege bien el m√≥vil en un paquete cerrado y entr√©galo al mensajero.`
        }],
        functioningTitle: '¬øC√≥mo funciona?',
        fixMyPhone: {
            title: 'Reparar mi m√≥vil',
        }
    });

    await webTexts.save();

    console.log('[SEED] Web texts created');
}

const clearWebTexts = async () => {
    await WebTexts.deleteMany({});
    console.log('[SEED] Web texts deleted');
}

const setInitialConfig = async () => {
    const configDocs = await Config.find();

    if (configDocs.length > 0) return;

    const config = new Config({
        initialPositionsPrices: false,
    });

    await config.save();

    console.log('[SEED] Config seeded! üå±');
}

const runSeeders = async () => {
    await initialPricesTableInfo();
    await setInitialProvinces();
    await createInitialStatus();
    await createInitialAdmin();
    await setInitialPricesRules();
    await setInitialWebTexts();
    await setInitialConfig();
}

module.exports = runSeeders;